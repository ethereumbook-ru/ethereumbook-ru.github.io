# Доп 3. Коды EVM и газ


Приложение A: Опкоды Ethereum EVM и потребление газа
Это приложение основано на работе по консолидации, проделанной людьми с сайта https://github.com/trailofbits/evm-opcodes в качестве справочника по опкодам и информации об инструкциях Ethereum VM (EVM), лицензированного по лицензии Apache License 2.0.
Таблица 1. Опкоды EVM и стоимость газа
Опкод
Имя
Описание
Дополнительная информация
Газ
0x00
СТОП
Прекращает исполнение
-
0
0x01
ДОБАВИТЬ
Операция сложения
-
3
0x02
MUL
Операция умножения
-
5
0x03
SUB
Операция вычитания
-
3
0x04
DIV
Операция целочисленного деления
-
5
0x05
SDIV
Операция деления знаковых целых чисел (усеченная)
-
5
0x06
MOD
Операция остатка по модулю
-
5
0x07
SMOD
Операция знакового остатка по модулю
-
5
0x08
ADDMOD
Операция сложения по модулю
-
8
0x09
MULMOD
Операция умножения по модулю
-
8
0x0a
EXP
Экспоненциальная операция
-
10***
0x0b
ПОДПИСАТЬСЯ
Увеличение длины двух комплементарных знаковых целых чисел
-
5
0x0c - 0x0f
Неиспользованный
Неиспользованный
-


0x10
LT
Меньшее сравнение
-
3
0x11
GT
Сравнение "больше-меньше
-
3
0x12
SLT
Подписанное сравнение
-
3
0x13
SGT
Подписанное сравнение "больше-меньше
-
3
0x14
ЭКВАЛАЙЗЕР
Сравнение равенства
-
3
0x15
ISZERO
Простой оператор NOT
-
3
0x16
И
Побитовая операция AND
-
3
0x17
ИЛИ
Операция побитового ИЛИ
-
3
0x18
XOR
Побитовая операция XOR
-
3
0x19
НЕ
Побитовая операция НЕ
-
3
0x1a
BYTE
Извлечение одного байта из слова
-
3
0x1b - 0x1f
Неиспользованный
Неиспользованный
-


0x20
SHA3
Вычислить хэш Keccak-256
-
30
0x21 - 0x2f
Неиспользованный
Неиспользованный
-


0x30
АДРЕС
Получить адрес текущего исполняемого счета
-
2
0x31
БАЛАНС
Получить баланс заданного счета
-
400
0x32
ORIGIN
Получить адрес начала исполнения
-
2
0x33
ЗВОНОК
Получить адрес абонента
-
2
0x34
CALLVALUE
Получение депонированного значения инструкцией/транзакцией, ответственной за данное выполнение
-
2
0x35
CALLDATALOAD
Получение входных данных текущей среды
-
3
0x36
CALLDATASIZE
Получить размер входных данных в текущей среде
-
2
0x37
CALLDATACOPY
Копирование входных данных в текущей среде в память
-
3
0x38
КОДЕЗИРОВАТЬ
Получить размер кода, выполняемого в текущей среде
-
2
0x39
CODECOPY
Копирование кода, выполняющегося в текущей среде, в память
-
3
0x3a
GASPRICE
Получить цену на газ в текущих условиях
-
2
0x3b
EXTCODESIZE
Получение размера кода счета
-
700
0x3c
EXTCODECOPY
Копирование кода счета в память
-
700
0x3d
RETURNDATASIZE
Вставляет размер буфера данных возврата в стек
ЭИП-211
2
0x3e
RETURNDATACOPY
Копирует данные из буфера данных возврата в память
ЭИП-211
3
0x3f
Неиспользованный
-
-


0x40
BLOCKHASH
Получение хэша одного из 256 последних полных блоков
-
20
0x41
COINBASE
Получить адрес получателя блока
-
2
0x42
TIMESTAMP
Получение временной метки блока
-
2
0x43
ЧИСЛО
Получить номер блока
-
2
0x44
ДИФФИКУЛЬТНОСТЬ
Получение сложности блока
-
2
0x45
ГАЗЛИМИТ
Получить предел газа блока
-
2
0x46 - 0x4f
Неиспользованный
-
-


0x50
POP
Удалить слово из стека
-
2
0x51
MLOAD
Загрузка слова из памяти
-
3
0x52
MSTORE
Сохранить слово в памяти
-
3*
0x53
MSTORE8
Сохранить байт в памяти
-
3
0x54
SLOAD
Загрузка слова из памяти
-
200
0x55
SSTORE
Сохранить слово в хранилище
-
0*
0x56
JUMP
Изменение программного счетчика
-
8
0x57
JUMPI
Условное изменение программного счетчика
-
10
0x58
GETPC
Получить значение программного счетчика до инкремента
-
2
0x59
MSIZE
Получить размер активной памяти в байтах
-
2
0x5a
ГАЗ
Получить количество доступного газа, включая соответствующее уменьшение количества доступного газа
-
2
0x5b
JUMPDEST
Отметьте действительное место назначения для прыжков
-
1
0x5c - 0x5f
Неиспользованный
-
-


0x60
PUSH1
Поместите 1-байтовый элемент в стек
-
3
0x61
PUSH2
Поместите 2-байтовый элемент в стек
-
3
0x62
PUSH3
Поместите 3-байтовый элемент в стек
-
3
0x63
PUSH4
Поместите 4-байтовый элемент в стек
-
3
0x64
PUSH5
Поместите 5-байтовый элемент в стек
-
3
0x65
PUSH6
Поместите 6-байтовый элемент в стек
-
3
0x66
PUSH7
Поместите 7-байтовый элемент в стек
-
3
0x67
PUSH8
Поместите 8-байтовый элемент в стек
-
3
0x68
PUSH9
Поместите 9-байтовый элемент в стек
-
3
0x69
PUSH10
Поместите 10-байтовый элемент в стек
-
3
0x6a
PUSH11
Поместите 11-байтовый элемент в стек
-
3
0x6b
PUSH12
Поместите 12-байтовый элемент в стек
-
3
0x6c
PUSH13
Поместите 13-байтовый элемент в стек
-
3
0x6d
PUSH14
Поместите 14-байтовый элемент в стек
-
3
0x6e
PUSH15
Поместите 15-байтовый элемент в стек
-
3
0x6f
PUSH16
Поместите 16-байтовый элемент в стек
-
3
0x70
PUSH17
Поместите 17-байтовый элемент в стек
-
3
0x71
PUSH18
Поместите 18-байтовый элемент в стек
-
3
0x72
PUSH19
Поместите 19-байтовый элемент в стек
-
3
0x73
PUSH20
Поместите 20-байтовый элемент в стек
-
3
0x74
PUSH21
Поместите 21-байтовый элемент в стек
-
3
0x75
PUSH22
Поместите 22-байтовый элемент в стек
-
3
0x76
ПУШ23
Поместите 23-байтовый элемент в стек
-
3
0x77
PUSH24
Поместите 24-байтовый элемент в стек
-
3
0x78
PUSH25
Поместите 25-байтовый элемент в стек
-
3
0x79
ПУШ26
Поместите 26-байтовый элемент в стек
-
3
0x7a
PUSH27
Поместите 27-байтовый элемент в стек
-
3
0x7b
PUSH28
Поместите 28-байтовый элемент в стек
-
3
0x7c
ПУШ29
Поместите 29-байтовый элемент в стек
-
3
0x7d
PUSH30
Поместите 30-байтовый элемент в стек
-
3
0x7e
PUSH31
Поместите 31-байтовый элемент в стек
-
3
0x7f
PUSH32
Поместите 32-байтовый элемент (полное слово) в стек
-
3
0x80
DUP1
Дублирование 1-го элемента стека
-
3
0x81
DUP2
Дублирование 2-го элемента стека
-
3
0x82
DUP3
Дублирование 3-го элемента стека
-
3
0x83
DUP4
Дублирование 4-го элемента стека
-
3
0x84
DUP5
Дублирование 5-го элемента стека
-
3
0x85
DUP6
Дублирование 6-го элемента стека
-
3
0x86
DUP7
Дублирование 7-го элемента стека
-
3
0x87
DUP8
Дублирование 8-го элемента стека
-
3
0x88
DUP9
Дублирование 9-го элемента стека
-
3
0x89
DUP10
Дублирование 10-го элемента стека
-
3
0x8a
DUP11
Дублирование 11-го элемента стека
-
3
0x8b
DUP12
Дублирование 12-го элемента стека
-
3
0x8c
DUP13
Дублирование 13-го элемента стека
-
3
0x8d
DUP14
Дублирование 14-го элемента стека
-
3
0x8e
DUP15
Дублирование 15-го элемента стека
-
3
0x8f
DUP16
Дублирование 16-го элемента стека
-
3
0x90
SWAP1
Обменяйте предметы 1-го и 2-го стека
-
3
0x91
SWAP2
Обмен 1-го и 3-го предметов стека
-
3
0x92
SWAP3
Обмен 1-го и 4-го элементов стека
-
3
0x93
SWAP4
Обмен 1-го и 5-го предметов стека
-
3
0x94
SWAP5
Обмен 1-го и 6-го элементов стека
-
3
0x95
SWAP6
Обмен 1-го и 7-го элементов стека
-
3
0x96
SWAP7
Обмен 1-го и 8-го элементов стека
-
3
0x97
SWAP8
Обмен 1-го и 9-го элементов стека
-
3
0x98
SWAP9
Обмен 1-го и 10-го предметов стека
-
3
0x99
SWAP10
Обмен 1-го и 11-го элементов стека
-
3
0x9a
SWAP11
Обмен 1-го и 12-го элементов стека
-
3
0x9b
SWAP12
Обмен 1-го и 13-го элементов стека
-
3
0x9c
SWAP13
Обмен 1-го и 14-го элементов стека
-
3
0x9d
SWAP14
Обмен 1-го и 15-го стеков
-
3
0x9e
SWAP15
Обмен 1-го и 16-го стеков
-
3
0x9f
SWAP16
Обмен 1-го и 17-го элементов стека
-
3
0xa0
LOG0
Добавление записи журнала без тем
-
375
0xa1
LOG1
Дополнить запись журнала одной темой
-
750
0xa2
LOG2
Добавьте запись журнала с двумя темами
-
1125
0xa3
LOG3
Добавьте запись журнала с тремя темами
-
1500
0xa4
LOG4
Добавьте запись журнала с четырьмя темами
-
1875
0xa5 - 0xaf
Неиспользованный
-
-


0xb0
JUMPTO
Ориентировочно libevmasm имеет другие номера
EIP 615


0xb1
JUMPIF
Предварительный
EIP-615


0xb2
JUMPSUB
Предварительный
EIP-615


0xb4
JUMPSUBV
Предварительный
EIP-615


0xb5
BEGINSUB
Предварительный
EIP-615


0xb6
BEGINDATA
Предварительный
EIP-615


0xb8
RETURNSUB
Предварительный
EIP-615


0xb9
PUTLOCAL
Предварительный
EIP-615


0xba
GETLOCA
Предварительный
EIP-615


0xbb - 0xe0
Неиспользованный
-
-


0xe1
SLOADBYTES
Только в pyethereum
-
-
0xe2
СТОРЕБЫТЫ
Только в pyethereum
-
-
0xe3
SSIZE
Только в pyethereum
-
-
0xe4 - 0xef
Неиспользованный
-
-


0xf0
CREATE
Создайте новую учетную запись с ассоциированным кодом
-
32000
0xf1
ЗВОНИТЕ
Сообщение-вызов на счет
-
Сложный
0xf2
CALLCODE
Сообщение-звонок на этот счет с кодом альтернативного счета
-
Сложный
0xf3
RETURN
Остановить выполнение, возвращая выходные данные
-
0
0xf4
DELEGATECALL
Сообщение-вызов на этот счет с кодом альтернативного счета, но сохраняющееся на этот счет с кодом альтернативного счета
-
Сложный
0xf5
CALLBLACKBOX
-
-
40
0xf6 - 0xf9
Неиспользованный
-
-


0xfa
STATICCALL
Аналогично CALL, но не изменяет состояние
-
40
0xfb
CREATE2
Создайте новый аккаунт и установите адрес создания в sha3(отправитель + sha3(код инициации)) % 2**160
-


0xfc
TXEXECGAS
Не в желтой бумаге FIXME
-
-
0xfd
РЕВЕРТ
Остановить выполнение и вернуть изменения состояния, не расходуя весь предоставленный газ и не указывая причину
-
0
0xfe
ИНВАЛИД
Недействительная инструкция
-
0
0xff
SELFDESTRUCT
Остановить выполнение и зарегистрировать учетную запись для последующего удаления
-
5000*


